<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ì–´ ë‹¨ì–´ í€´ì¦ˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #d6e0f5, #f5f9ff);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header {
            width: 100%;
            background: rgba(255,255,255,0.25);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.3);
            padding: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            box-sizing: border-box;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .logo {
            font-size: 1.8em;
            font-weight: bold;
            color: #7b68ee;
            text-decoration: none;
            margin-right: 30px;
        }

        #searchInput {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .header-right {
            display: flex;
            align-items: center;
        }

        .header-right a {
            text-decoration: none;
            margin-left: 15px;
            font-size: 0.95em;
            font-weight: 500;
            color: #555;
            transition: color 0.3s;
        }

        .header-right a:hover {
            color: #0076ff;
        }

        #studyPanel {
            display: none;
            position: absolute;
            top: calc(100% + 5px);
            right: 20px;
            width: 450px;
            background: #fff;
            border: 1px solid #e1e1e1;
            border-radius: 8px;
            padding: 20px;
            z-index: 100;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        #wrongAnswersPanel {
            display: none;
            position: absolute;
            top: calc(100% + 5px);
            right: 20px;
            width: 500px;
            background: #fff;
            border: 1px solid #e1e1e1;
            border-radius: 8px;
            padding: 20px;
            z-index: 100;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .panel h2 { 
            margin-bottom: 15px; 
            font-size: 1.2rem; 
            color: #333;
        }

        #studyContent {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: calc(100% - 12px);
            font-size: 1rem;
            resize: vertical;
            height: 120px;
            box-sizing: border-box;
        }

        #addStudyContentBtn {
            margin-top: 10px;
            padding: 8px 12px;
            background: #0076ff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 1rem;
        }

        #addStudyContentBtn:hover { background: #005bb5; }

        #studyNotesList {
            margin-top: 20px;
            text-align: left;
            list-style: decimal inside;
            padding-left: 0;
        }

        #studyNotesList li {
            background-color: #f9f9f9;
            border: 1px solid #eee;
            padding: 8px 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #studyNotesList li button {
            background-color: #ff4d4f;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.85em;
        }

        #studyNotesList li button:hover {
            background-color: #d9363e;
        }

        /* ì˜¤ë‹µë…¸íŠ¸ ìŠ¤íƒ€ì¼ */
        #wrongAnswersList {
            margin-top: 15px;
            text-align: left;
            list-style: none;
            padding-left: 0;
            max-height: 300px;
            overflow-y: auto;
        }

        #wrongAnswersList li {
            background-color: #fff5f5;
            border: 1px solid #ffcdd2;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .wrong-answer-content {
            flex: 1;
        }

        .wrong-answer-word {
            font-weight: bold;
            font-size: 1.1em;
            color: #d32f2f;
            margin-bottom: 5px;
        }

        .wrong-answer-details {
            font-size: 0.9em;
            color: #666;
        }

        .wrong-answer-buttons {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .retry-btn {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .retry-btn:hover {
            background-color: #45a049;
        }

        .delete-wrong-btn {
            background-color: #ff4d4f;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .delete-wrong-btn:hover {
            background-color: #d9363e;
        }

        .clear-all-wrong-btn {
            background-color: #ff9800;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .clear-all-wrong-btn:hover {
            background-color: #f57c00;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .container h1 {
            margin-bottom: 20px;
            color: #0076ff;
        }

        .quiz-grid {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            gap: 30px;
            width: 100%;
            margin-top: 20px;
        }

        .refresh-btn {
            margin-bottom: 20px;
            padding: 10px 15px;
            background: #28a745;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 1rem;
        }

        .refresh-btn:hover { background: #218838; }

        .my-quiz-container {
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            padding: 20px;
            box-sizing: border-box;
            margin: 0 auto;
        }

        .my-question-section {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 25px;
            width: 100%;
        }

        .my-word-to-learn {
            text-align: center;
            width: 100%;
        }

        .my-word-to-learn h2 {
            font-size: 2.2em;
            color: #333;
            margin-top: 0;
            margin-bottom: 5px;
            text-transform: capitalize;
        }

        .my-word-to-learn .my-feedback {
            font-size: 1.1em;
            font-weight: bold;
            margin: 0;
            min-height: 1.2em;
        }

        .my-options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .my-option {
            background-color: #ffffff;
            border: 1px solid #d0d0d0;
            border-radius: 8px;
            padding: 15px;
            font-size: 1em;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
        }

        .my-option:hover { background-color: #f8f9fa; }
        .my-option.selected { font-weight: bold; }
        
        .my-option.correct-answer {
            border-color: #28a745;
            background-color: #e6ffed;
            color: #28a745;
        }

        .my-option.incorrect-answer {
            border-color: #dc3545;
            background-color: #ffebee;
            color: #dc3545;
        }

        .my-option.correct-answer::before { content: 'âœ“ '; font-weight: bold; }
        .my-option.incorrect-answer::before { content: 'âœ— '; font-weight: bold; }

        @media (max-width: 768px) {
            #searchInput { width: 150px; }
            .my-quiz-container { width: 90%; padding: 15px; }
            .my-word-to-learn h2 { font-size: 1.8em; }
            .my-option { padding: 12px; font-size: 0.9em; }
            #studyPanel, #wrongAnswersPanel { width: 90%; max-width: 400px; right: 5%; }
        }

        @media (max-width: 480px) {
            .header-container { flex-direction: column; align-items: flex-start; gap: 10px;}
            .header-right { width: 100%; justify-content: space-around; margin-top: 5px;}
            .header-right a { margin-left: 0;}
            .my-question-section { flex-direction: column; align-items: center; }
            .my-word-to-learn { text-align: center; }
            .my-word-to-learn h2 { font-size: 1.6em; }
            #studyPanel, #wrongAnswersPanel { width: calc(100% - 40px) ; right: 20px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-container">
            <div class="header-left">
                <a href="#" class="logo">EduQuiz</a>
                <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ (ì˜ì–´ ë‹¨ì–´)">
            </div>
            <div class="header-right">
                <a href="#" id="homeLink">í™ˆ</a>
                <a href="#" id="studyNav">í•™ìŠµë‚´ìš©</a>
                <a href="#" id="wrongAnswersNav">ì˜¤ë‹µë…¸íŠ¸</a>
            </div>
        </div>
        
        <!-- í•™ìŠµë‚´ìš© íŒ¨ë„ -->
        <div id="studyPanel" class="panel">
            <h2>í•™ìŠµ ë‚´ìš© ì €ì¥ ë° ì¶”ê°€</h2>
            <textarea id="studyContent" placeholder="í•™ìŠµí•œ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea><br>
            <button id="addStudyContentBtn">í•™ìŠµ ë‚´ìš© ì¶”ê°€</button>
            <ul id="studyNotesList"></ul>
        </div>

        <!-- ì˜¤ë‹µë…¸íŠ¸ íŒ¨ë„ -->
        <div id="wrongAnswersPanel" class="panel">
            <h2>ì˜¤ë‹µë…¸íŠ¸ ğŸ“</h2>
            <p style="color: #666; font-size: 0.9em; margin-bottom: 15px;">í‹€ë¦° ë¬¸ì œë“¤ì´ ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.</p>
            <ul id="wrongAnswersList"></ul>
            <button id="clearAllWrongBtn" class="clear-all-wrong-btn">ëª¨ë“  ì˜¤ë‹µ ì‚­ì œ</button>
        </div>
    </header>

    <div class="container">
        <h1>ì˜ì–´ ë‹¨ì–´ í€´ì¦ˆ</h1>
        <button class="refresh-btn" id="refreshBtn">ìƒˆë¡œìš´ ë¬¸ì œ</button>
        <div class="quiz-grid" id="quizGrid"></div>
    </div>

    <script>
        const baseWords = [
            { en: "apple", ko: "ì‚¬ê³¼" }, { en: "book", ko: "ì±…" }, { en: "car", ko: "ìë™ì°¨" },
            { en: "dog", ko: "ê°œ" }, { en: "house", ko: "ì§‘" }, { en: "tree", ko: "ë‚˜ë¬´" },
            { en: "computer", ko: "ì»´í“¨í„°" }, { en: "phone", ko: "ì „í™”ê¸°" }, { en: "river", ko: "ê°•" },
            { en: "city", ko: "ë„ì‹œ" }, { en: "happy", ko: "í–‰ë³µí•œ" }, { en: "blue", ko: "íŒŒë€" },
            { en: "bright", ko: "ë°ì€" }, { en: "tall", ko: "í‚¤ í°" }, { en: "old", ko: "ëŠ™ì€/ì˜¤ë˜ëœ" },
            { en: "young", ko: "ì Šì€" }, { en: "smart", ko: "ë˜‘ë˜‘í•œ" }, { en: "quiet", ko: "ì¡°ìš©í•œ" },
            { en: "loud", ko: "ì‹œë„ëŸ¬ìš´" }, { en: "gentle", ko: "ë¶€ë“œëŸ¬ìš´" }, { en: "water", ko: "ë¬¼" },
            { en: "fire", ko: "ë¶ˆ" }, { en: "earth", ko: "í™/ì§€êµ¬" }, { en: "wind", ko: "ë°”ëŒ" },
            { en: "sun", ko: "íƒœì–‘" }, { en: "moon", ko: "ë‹¬" }, { en: "star", ko: "ë³„" },
            { en: "sky", ko: "í•˜ëŠ˜" }, { en: "friend", ko: "ì¹œêµ¬" }, { en: "love", ko: "ì‚¬ë‘" },
            { en: "time", ko: "ì‹œê°„" }, { en: "world", ko: "ì„¸ê³„" }, { en: "school", ko: "í•™êµ" },
            { en: "student", ko: "í•™ìƒ" }, { en: "teacher", ko: "ì„ ìƒë‹˜" }, { en: "big", ko: "í°" },
            { en: "small", ko: "ì‘ì€" }, { en: "fast", ko: "ë¹ ë¥¸" }, { en: "slow", ko: "ëŠë¦°" },
            { en: "beautiful", ko: "ì•„ë¦„ë‹¤ìš´" }, { en: "strong", ko: "ê°•í•œ" }, { en: "weak", ko: "ì•½í•œ" },
            { en: "good", ko: "ì¢‹ì€" }, { en: "bad", ko: "ë‚˜ìœ" }, { en: "new", ko: "ìƒˆë¡œìš´" },
            { en: "red", ko: "ë¹¨ê°„ìƒ‰" }, { en: "green", ko: "ì´ˆë¡ìƒ‰" }, { en: "yellow", ko: "ë…¸ë€ìƒ‰" },
            { en: "white", ko: "í°ìƒ‰" }, { en: "black", ko: "ê²€ì€ìƒ‰" }, { en: "day", ko: "ë‚®/ë‚ " },
            { en: "night", ko: "ë°¤" }, { en: "music", ko: "ìŒì•…" }, { en: "food", ko: "ìŒì‹" },
            { en: "game", ko: "ê²Œì„" }, { en: "art", ko: "ì˜ˆìˆ " }, { en: "flower", ko: "ê½ƒ" },
            { en: "mountain", ko: "ì‚°" }, { en: "ocean", ko: "ë°”ë‹¤" }, { en: "light", ko: "ë¹›" },
            { en: "dark", ko: "ì–´ë‘ìš´" }, { en: "hot", ko: "ë”ìš´" }, { en: "cold", ko: "ì¶”ìš´" },
            { en: "road", ko: "ê¸¸" }, { en: "door", ko: "ë¬¸" }, { en: "window", ko: "ì°½ë¬¸" },
            { en: "chair", ko: "ì˜ì" }, { en: "table", ko: "íƒì" }, { en: "pen", ko: "íœ" },
            { en: "pencil", ko: "ì—°í•„" }, { en: "paper", ko: "ì¢…ì´" }, { en: "money", ko: "ëˆ" },
            { en: "dream", ko: "ê¿ˆ" }, { en: "work", ko: "ì¼/ì‘ì—…" }, { en: "play", ko: "ë†€ì´/ë†€ë‹¤" },
            { en: "walk", ko: "ê±·ë‹¤" }, { en: "run", ko: "ë‹¬ë¦¬ë‹¤" }, { en: "eat", ko: "ë¨¹ë‹¤" },
            { en: "drink", ko: "ë§ˆì‹œë‹¤" }, { en: "sleep", ko: "ìë‹¤" }, { en: "read", ko: "ì½ë‹¤" },
            { en: "write", ko: "ì“°ë‹¤" }, { en: "speak", ko: "ë§í•˜ë‹¤" }, { en: "listen", ko: "ë“£ë‹¤" },
            { en: "think", ko: "ìƒê°í•˜ë‹¤" }, { en: "learn", ko: "ë°°ìš°ë‹¤" }, { en: "teach", ko: "ê°€ë¥´ì¹˜ë‹¤" },
            { en: "help", ko: "ë•ë‹¤" }, { en: "use", ko: "ì‚¬ìš©í•˜ë‹¤" }, { en: "make", ko: "ë§Œë“¤ë‹¤" },
            { en: "give", ko: "ì£¼ë‹¤" }, { en: "take", ko: "ê°€ì ¸ê°€ë‹¤" }, { en: "see", ko: "ë³´ë‹¤" },
            { en: "look", ko: "ë°”ë¼ë³´ë‹¤" }, { en: "find", ko: "ì°¾ë‹¤" }, { en: "know", ko: "ì•Œë‹¤" },
            { en: "feel", ko: "ëŠë¼ë‹¤" }, { en: "come", ko: "ì˜¤ë‹¤" }, { en: "go", ko: "ê°€ë‹¤" },
            { en: "easy", ko: "ì‰¬ìš´" }, { en: "hard", ko: "ì–´ë ¤ìš´/ë‹¨ë‹¨í•œ" }, { en: "kind", ko: "ì¹œì ˆí•œ" },
            { en: "rich", ko: "ë¶€ìœ í•œ" }, { en: "poor", ko: "ê°€ë‚œí•œ" }, { en: "always", ko: "í•­ìƒ" },
            { en: "never", ko: "ê²°ì½” ~ì•Šë‹¤" }, { en: "often", ko: "ìì£¼" }, { en: "sometimes", ko: "ë•Œë•Œë¡œ" }
        ];

        const wordPool = [];
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í‚¤ ìƒìˆ˜
        const LOCAL_STORAGE_STUDY_NOTES_KEY = 'engVocabStudyNotes';
        const LOCAL_STORAGE_WRONG_ANSWERS_KEY = 'engVocabWrongAnswers';
        
        // DOM ìš”ì†Œ ì°¸ì¡°
        const studyNav = document.getElementById("studyNav");
        const studyPanel = document.getElementById("studyPanel");
        const studyContent = document.getElementById("studyContent");
        const addStudyContentBtn = document.getElementById("addStudyContentBtn");
        const studyNotesList = document.getElementById("studyNotesList");
        
        const wrongAnswersNav = document.getElementById("wrongAnswersNav");
        const wrongAnswersPanel = document.getElementById("wrongAnswersPanel");
        const wrongAnswersList = document.getElementById("wrongAnswersList");
        const clearAllWrongBtn = document.getElementById("clearAllWrongBtn");

        function populateWordPool(count = 200) {
            wordPool.length = 0;
            if (baseWords.length === 0) {
                console.error("ê¸°ë³¸ ë‹¨ì–´ ëª©ë¡ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤!");
                return;
            }
            for (let i = 0; i < count; i++) {
                const randomIndex = Math.floor(Math.random() * baseWords.length);
                wordPool.push(baseWords[randomIndex]);
            }
        }

        function generateRandomEnglishQuizData() {
            if (wordPool.length === 0) {
                populateWordPool();
                if (wordPool.length === 0) {
                    return {
                        id: "error_quiz",
                        word: "Error",
                        choices: ["-", "-", "-", "-"],
                        answer: "-",
                        feedbackCorrect: "",
                        feedbackIncorrect: "ë‹¨ì–´ í’€ ë¡œë”© ì‹¤íŒ¨"
                    };
                }
            }

            const chosenWordPair = wordPool[Math.floor(Math.random() * wordPool.length)];
            const englishWord = chosenWordPair.en;
            const correctKoreanMeaning = chosenWordPair.ko;

            let otherKoreanMeanings = baseWords
                .filter(pair => pair.ko !== correctKoreanMeaning)
                .map(pair => pair.ko);
            
            otherKoreanMeanings = [...new Set(otherKoreanMeanings)];
            otherKoreanMeanings.sort(() => Math.random() - 0.5);

            const choices = otherKoreanMeanings.slice(0, 3);
            choices.push(correctKoreanMeaning);
            choices.sort(() => Math.random() - 0.5);

            const finalUniqueChoices = [...new Set(choices)].slice(0, 4);
            while (finalUniqueChoices.length < 4 && baseWords.length >= 4) {
                const randomFallback = baseWords[Math.floor(Math.random() * baseWords.length)].ko;
                if (!finalUniqueChoices.includes(randomFallback)) {
                    finalUniqueChoices.push(randomFallback);
                }
            }

            return {
                id: `en_quiz_${Date.now()}_${Math.random().toString(16).slice(2)}`,
                word: englishWord,
                choices: finalUniqueChoices,
                answer: correctKoreanMeaning,
                feedbackCorrect: "ì •ë‹µì…ë‹ˆë‹¤!",
                feedbackIncorrect: "ì˜¤ë‹µì…ë‹ˆë‹¤."
            };
        }

        // íŠ¹ì • ë‹¨ì–´ë¡œ í€´ì¦ˆ ìƒì„± (ì˜¤ë‹µë…¸íŠ¸ì—ì„œ ì¬ì‹œë„í•  ë•Œ ì‚¬ìš©)
        function generateQuizFromWord(word, correctAnswer) {
            let otherKoreanMeanings = baseWords
                .filter(pair => pair.ko !== correctAnswer)
                .map(pair => pair.ko);
            
            otherKoreanMeanings = [...new Set(otherKoreanMeanings)];
            otherKoreanMeanings.sort(() => Math.random() - 0.5);

            const choices = otherKoreanMeanings.slice(0, 3);
            choices.push(correctAnswer);
            choices.sort(() => Math.random() - 0.5);

            return {
                id: `retry_quiz_${Date.now()}_${Math.random().toString(16).slice(2)}`,
                word: word,
                choices: choices,
                answer: correctAnswer,
                feedbackCorrect: "ì •ë‹µì…ë‹ˆë‹¤!",
                feedbackIncorrect: "ì˜¤ë‹µì…ë‹ˆë‹¤."
            };
        }

        // ì˜¤ë‹µ ì €ì¥ í•¨ìˆ˜
        function saveWrongAnswer(word, correctAnswer, userAnswer) {
            const wrongAnswers = JSON.parse(localStorage.getItem(LOCAL_STORAGE_WRONG_ANSWERS_KEY)) || [];
            
            // ì¤‘ë³µ ì²´í¬ (ê°™ì€ ë‹¨ì–´ê°€ ì´ë¯¸ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸)
            const existingIndex = wrongAnswers.findIndex(item => item.word === word);
            
            const wrongAnswerData = {
                word: word,
                correctAnswer: correctAnswer,
                userAnswer: userAnswer,
                timestamp: new Date().toLocaleDateString('ko-KR')
            };

            if (existingIndex !== -1) {
                wrongAnswers[existingIndex] = wrongAnswerData; // ê¸°ì¡´ í•­ëª© ì—…ë°ì´íŠ¸
            } else {
                wrongAnswers.push(wrongAnswerData); // ìƒˆ í•­ëª© ì¶”ê°€
            }

            localStorage.setItem(LOCAL_STORAGE_WRONG_ANSWERS_KEY, JSON.stringify(wrongAnswers));
        }

        // ì˜¤ë‹µë…¸íŠ¸ ë Œë”ë§ í•¨ìˆ˜
        function renderWrongAnswers() {
            wrongAnswersList.innerHTML = "";
            const wrongAnswers = JSON.parse(localStorage.getItem(LOCAL_STORAGE_WRONG_ANSWERS_KEY)) || [];
            
            if (wrongAnswers.length === 0) {
                const emptyMessage = document.createElement("li");
                emptyMessage.style.textAlign = "center";
                emptyMessage.style.color = "#999";
                emptyMessage.style.fontStyle = "italic";
                emptyMessage.style.border = "none";
                emptyMessage.style.background = "transparent";
                emptyMessage.textContent = "ì•„ì§ í‹€ë¦° ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤! ğŸ‰";
                wrongAnswersList.appendChild(emptyMessage);
                return;
            }

            wrongAnswers.forEach((item, index) => {
                const listItem = document.createElement("li");
                
                const contentDiv = document.createElement("div");
                contentDiv.className = "wrong-answer-content";
                
                const wordDiv = document.createElement("div");
                wordDiv.className = "wrong-answer-word";
                wordDiv.textContent = item.word;
                
                const detailsDiv = document.createElement("div");
                detailsDiv.className = "wrong-answer-details";
                detailsDiv.innerHTML = `
                    ì •ë‹µ: <strong>${item.correctAnswer}</strong><br>
                    ì„ íƒ: <span style="color: #d32f2f;">${item.userAnswer}</span><br>
                    <small>ë‚ ì§œ: ${item.timestamp}</small>
                `;
                
                contentDiv.appendChild(wordDiv);
                contentDiv.appendChild(detailsDiv);
                
                const buttonsDiv = document.createElement("div");
                buttonsDiv.className = "wrong-answer-buttons";
                
                const retryBtn = document.createElement("button");
                retryBtn.className = "retry-btn";
                retryBtn.textContent = "ë‹¤ì‹œí’€ê¸°";
                retryBtn.onclick = function() {
                    // í•´ë‹¹ ë‹¨ì–´ë¡œ ìƒˆë¡œìš´ í€´ì¦ˆ ìƒì„±
                    quizData = [generateQuizFromWord(item.word, item.correctAnswer)];
                    renderCards();
                    // íŒ¨ë„ ë‹«ê¸°
                    wrongAnswersPanel.style.display = "none";
                };
                
                const deleteBtn = document.createElement("button");
                deleteBtn.className = "delete-wrong-btn";
                deleteBtn.textContent = "ì‚­ì œ";
                deleteBtn.onclick = function() {
                    deleteWrongAnswer(index);
                };
                
                buttonsDiv.appendChild(retryBtn);
                buttonsDiv.appendChild(deleteBtn);
                
                listItem.appendChild(contentDiv);
                listItem.appendChild(buttonsDiv);
                wrongAnswersList.appendChild(listItem);
            });
        }

        // íŠ¹ì • ì˜¤ë‹µ ì‚­ì œ í•¨ìˆ˜
        function deleteWrongAnswer(index) {
            let wrongAnswers = JSON.parse(localStorage.getItem(LOCAL_STORAGE_WRONG_ANSWERS_KEY)) || [];
            wrongAnswers.splice(index, 1);
            localStorage.setItem(LOCAL_STORAGE_WRONG_ANSWERS_KEY, JSON.stringify(wrongAnswers));
            renderWrongAnswers();
        }

        // ëª¨ë“  ì˜¤ë‹µ ì‚­ì œ í•¨ìˆ˜
        function clearAllWrongAnswers() {
            if (confirm("ëª¨ë“  ì˜¤ë‹µì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                localStorage.removeItem(LOCAL_STORAGE_WRONG_ANSWERS_KEY);
                renderWrongAnswers();
            }
        }

        function createMyQuizDOM(data) {
            const quizContainer = document.createElement('div');
            quizContainer.className = 'my-quiz-container';

            const questionSection = document.createElement('div');
            questionSection.className = 'my-question-section';

            const wordToLearnDiv = document.createElement('div');
            wordToLearnDiv.className = 'my-word-to-learn';
            const wordH2 = document.createElement('h2');
            wordH2.textContent = data.word;
            const feedbackP = document.createElement('p');
            feedbackP.className = 'my-feedback';
            feedbackP.textContent = "ëœ»ì„ ì„ íƒí•˜ì„¸ìš”.";
            feedbackP.style.color = "#777";

            wordToLearnDiv.appendChild(wordH2);
            wordToLearnDiv.appendChild(feedbackP);

            questionSection.appendChild(wordToLearnDiv);
            quizContainer.appendChild(questionSection);

            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'my-options-container';
            
            data.choices.forEach(choiceText => {
                const optionButton = document.createElement('button');
                optionButton.className = 'my-option';
                optionButton.textContent = choiceText;

                optionButton.addEventListener('click', () => {
                    optionButton.classList.add('selected');
                    
                    if (choiceText === data.answer) {
                        optionButton.classList.add('correct-answer');
                        feedbackP.textContent = data.feedbackCorrect;
                        feedbackP.style.color = '#28a745';
                    } else {
                        optionButton.classList.add('incorrect-answer');
                        feedbackP.textContent = data.feedbackIncorrect;
                        feedbackP.style.color = '#dc3545';
                        
                        // ì˜¤ë‹µì¸ ê²½ìš° ì˜¤ë‹µë…¸íŠ¸ì— ì €ì¥
                        saveWrongAnswer(data.word, data.answer, choiceText);
                    }
                    
                    optionsContainer.querySelectorAll('.my-option').forEach(btn => {
                        btn.disabled = true;
                    });
                });
                optionsContainer.appendChild(optionButton);
            });
            quizContainer.appendChild(optionsContainer);
            return quizContainer;
        }

        let quizData = [generateRandomEnglishQuizData()];

        function renderCards() {
            const quizGrid = document.getElementById("quizGrid");
            quizGrid.innerHTML = "";
            if (quizData && quizData.length > 0 && quizData[0].word !== "Error") {
                const cardElement = createMyQuizDOM(quizData[0]);
                quizGrid.appendChild(cardElement);
            } else if (quizData[0] && quizData[0].word === "Error") {
                quizGrid.textContent = quizData[0].feedbackIncorrect || "í€´ì¦ˆë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
            }
        }

        // í•™ìŠµ ë‚´ìš© ë Œë”ë§ í•¨ìˆ˜
        function renderStudyNotes() {
            studyNotesList.innerHTML = "";
            const notes = JSON.parse(localStorage.getItem(LOCAL_STORAGE_STUDY_NOTES_KEY)) || [];
            notes.forEach((noteText, index) => {
                const listItem = document.createElement("li");
                
                const textSpan = document.createElement("span");
                textSpan.textContent = noteText;
                
                const deleteBtn = document.createElement("button");
                deleteBtn.textContent = "ì‚­ì œ";
                deleteBtn.onclick = function() {
                    deleteStudyNote(index);
                };

                listItem.appendChild(textSpan);
                listItem.appendChild(deleteBtn);
                studyNotesList.appendChild(listItem);
            });
        }

        // í•™ìŠµ ë‚´ìš© ì‚­ì œ í•¨ìˆ˜
        function deleteStudyNote(noteIndex) {
            let notes = JSON.parse(localStorage.getItem(LOCAL_STORAGE_STUDY_NOTES_KEY)) || [];
            notes.splice(noteIndex, 1);
            localStorage.setItem(LOCAL_STORAGE_STUDY_NOTES_KEY, JSON.stringify(notes));
            renderStudyNotes();
        }

        // íŒ¨ë„ ë‹«ê¸° í•¨ìˆ˜
        function closeAllPanels() {
            studyPanel.style.display = "none";
            wrongAnswersPanel.style.display = "none";
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.getElementById("refreshBtn").addEventListener("click", () => {
            quizData = [generateRandomEnglishQuizData()];
            renderCards();
        });

        document.getElementById("searchInput").addEventListener("input", (e) => {
            const query = e.target.value.toLowerCase().trim();
            const currentQuizContainer = document.querySelector(".my-quiz-container");
            if (currentQuizContainer) {
                const wordElement = currentQuizContainer.querySelector(".my-word-to-learn h2");
                if (wordElement) {
                    const wordText = wordElement.textContent.toLowerCase();
                    if (query === "") {
                        currentQuizContainer.style.border = "";
                    } else if (wordText.includes(query)) {
                        currentQuizContainer.style.border = "2px solid gold";
                    } else {
                        currentQuizContainer.style.border = "2px solid transparent";
                    }
                }
            }
        });

        document.getElementById("homeLink").addEventListener("click", (e) => {
            e.preventDefault();
            window.location.reload();
        });

        // í•™ìŠµ ë‚´ìš© íŒ¨ë„ í† ê¸€
        studyNav.addEventListener("click", (e) => {
            e.preventDefault();
            closeAllPanels();
            if (studyPanel.style.display !== "block") {
                studyPanel.style.display = "block";
                renderStudyNotes();
            }
        });

        // ì˜¤ë‹µë…¸íŠ¸ íŒ¨ë„ í† ê¸€
        wrongAnswersNav.addEventListener("click", (e) => {
            e.preventDefault();
            closeAllPanels();
            if (wrongAnswersPanel.style.display !== "block") {
                wrongAnswersPanel.style.display = "block";
                renderWrongAnswers();
            }
        });

        // í•™ìŠµ ë‚´ìš© ì¶”ê°€ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        addStudyContentBtn.addEventListener("click", () => {
            const noteText = studyContent.value.trim();
            if (noteText === "") {
                alert("í•™ìŠµ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            const notes = JSON.parse(localStorage.getItem(LOCAL_STORAGE_STUDY_NOTES_KEY)) || [];
            notes.push(noteText);
            localStorage.setItem(LOCAL_STORAGE_STUDY_NOTES_KEY, JSON.stringify(notes));

            studyContent.value = "";
            renderStudyNotes();
        });

        // ëª¨ë“  ì˜¤ë‹µ ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        clearAllWrongBtn.addEventListener("click", clearAllWrongAnswers);

        // ì™¸ë¶€ í´ë¦­ ì‹œ íŒ¨ë„ ë‹«ê¸°
        document.addEventListener("click", (e) => {
            if (!studyPanel.contains(e.target) && !studyNav.contains(e.target) &&
                !wrongAnswersPanel.contains(e.target) && !wrongAnswersNav.contains(e.target)) {
                closeAllPanels();
            }
        });

        // ì´ˆê¸°í™”
        populateWordPool(200);
        renderCards();
        renderStudyNotes();
        renderWrongAnswers();
    </script>
</body>
</html>